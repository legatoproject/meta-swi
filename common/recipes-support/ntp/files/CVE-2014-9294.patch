--- a/util/ntp-keygen.c
+++ b/util/ntp-keygen.c
@@ -267,7 +267,7 @@ main(
 	gethostname(hostbuf, MAXHOSTNAME);
 	hostname = hostbuf;
 	gettimeofday(&tv, 0);
-
+	ntp_srandom((u_long)(tv.tv_sec + tv.tv_usec));
 	epoch = tv.tv_sec;
 
 	{
@@ -721,7 +721,6 @@ gen_md5(
 #endif /* OPENSSL */
 
 	str = fheader("MD5key", id, groupname);
-	ntp_srandom((u_long)epoch);
 	for (i = 1; i <= MD5KEYS; i++) {
 		for (j = 0; j < MD5SIZE; j++) {
 			int temp;
